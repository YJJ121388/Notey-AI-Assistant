# Notey iOS App 转换说明文档

本文档详细说明了从 Figma 设计的 React/TypeScript Web 代码转换为 SwiftUI iOS 应用的完整过程。

## 📁 项目文件夹结构

```
Notey/
├── Models/                    # 数据模型
├── Views/                     # 视图层
│   ├── Main/                  # 主视图
│   └── Detail/                # 详情视图
├── Components/                # UI 组件
├── Sheets/                    # 底部表单
├── Extensions/                # 扩展
├── Managers/                  # 管理器
├── Assets.xcassets/          # 资源文件
├── ContentView.swift         # 主视图控制器
├── NoteyApp.swift            # 应用入口
└── Item.swift                # 示例数据模型（可删除）
```

---

## 📂 Models 文件夹

### 功能说明
存放应用的数据模型，定义数据结构。

### 文件列表

#### 1. `Note.swift`
- **功能**: 笔记数据模型
- **属性**:
  - `id: String` - 唯一标识符
  - `title: String` - 笔记标题
  - `icon: String` - 笔记图标（emoji）
  - `content: String?` - 笔记内容（可选）
  - `timestamp: Date?` - 时间戳（可选）
  - `createdAt: Date?` - 创建时间（可选）
  - `lastEdited: Date?` - 最后编辑时间（可选）
- **协议**: `Identifiable`, `Codable`
- **转换说明**: 从 React 的 TypeScript 接口转换为 Swift 结构体

#### 2. `Folder.swift`
- **功能**: 文件夹数据模型
- **属性**:
  - `id: String` - 唯一标识符
  - `title: String` - 文件夹标题
  - `icon: String` - 文件夹图标
  - `type: FolderType` - 文件夹类型（folder/file）
  - `children: [Note]?` - 子笔记列表（可选）
- **包含**: `DraftNote` 结构体（草稿笔记模型）
- **协议**: `Identifiable`, `Codable`
- **转换说明**: 从 React 的嵌套对象结构转换为 Swift 结构体

#### 3. `UserQuota.swift`
- **功能**: 用户额度数据模型
- **属性**:
  - `usedQuota: Int` - 已使用额度
  - `totalQuota: Int` - 总额度
  - `percentage: Double` - 使用百分比（计算属性）
  - `status: QuotaStatus` - 额度状态（计算属性）
- **枚举**: `QuotaStatus` (sufficient/warning/exceeded)
- **转换说明**: 从 React 的简单对象转换为 Swift 结构体，添加了计算属性

---

## 📂 Views/Main 文件夹

### 功能说明
存放应用的主要视图页面。

### 文件列表

#### 1. `HomeView.swift`
- **功能**: 最近内容主视图
- **主要组件**:
  - 最近笔记列表
  - 草稿箱/未录入笔记列表
- **子组件**: `NoteCardView` - 笔记卡片视图
- **状态管理**: 
  - `@Binding var uncategorizedNotes` - 未分类笔记
  - `@Binding var draftNotes` - 草稿笔记
- **转换说明**: 
  - 从 `RecentTab.tsx` 转换
  - React 的 `useState` 转换为 SwiftUI 的 `@State` 和 `@Binding`
  - Tailwind CSS 类转换为 SwiftUI 修饰符

#### 2. `LibraryView.swift`
- **功能**: 我的笔记库视图
- **主要功能**:
  - 收藏的笔记（横向滚动网格）
  - 我的收藏（可展开列表）
  - 我的笔记（文件夹树形结构）
  - 未分类笔记（可展开列表）
- **状态管理**:
  - `@State private var expandedFolders` - 展开的文件夹
  - `@State private var favorites` - 收藏的笔记ID集合
  - `@State private var isFavoritesExpanded` - 收藏列表展开状态
- **交互功能**:
  - 文件夹展开/折叠
  - 收藏/取消收藏
  - 删除笔记
  - 添加文件夹
  - 分类选择
- **转换说明**:
  - 从 `MyNotesTab.tsx` 转换
  - React 的 `Set` 转换为 Swift 的 `Set<String>`
  - React 的 `useEffect` 转换为 SwiftUI 的 `onAppear`
  - 复杂的条件渲染转换为 SwiftUI 的 `if-else` 视图构建器

#### 3. `SettingsView.swift`
- **功能**: 设置主视图
- **设置项**:
  - 用户额度
  - 通知
  - 数据管理
  - 帮助与支持
- **转换说明**: 从 `SettingsTab.tsx` 转换

#### 4. `NotificationSettingsView.swift`
- **功能**: 通知设置视图
- **主要功能**:
  - 记录完成通知开关
- **转换说明**: 从 `NotificationSettingsPage.tsx` 转换
- **特殊处理**: iOS 原生 `Toggle` 组件替代自定义开关

#### 5. `DataManagementView.swift`
- **功能**: 数据管理视图
- **主要功能**:
  - 显示已用存储空间
  - 导出所有笔记
  - 分享表单
- **转换说明**: 从 `DataManagementPage.tsx` 转换

---

## 📂 Views/Detail 文件夹

### 功能说明
存放详情页面视图。

### 文件列表

#### 1. `NoteDetailView.swift`
- **功能**: 笔记详情视图（支持编辑）
- **主要功能**:
  - 阅读模式：显示笔记内容
  - 编辑模式：可编辑标题和内容
  - 笔记信息：创建时间、最后编辑、字数统计
- **状态管理**:
  - `@State private var isEditing` - 编辑状态
  - `@State private var editedTitle` - 编辑中的标题
  - `@State private var editedContent` - 编辑中的内容
- **转换说明**:
  - 从 `NoteDetailPage.tsx` 转换
  - React 的条件渲染转换为 SwiftUI 的 `if-else` 视图
  - 文本编辑器使用 SwiftUI 的 `TextEditor`

#### 2. `DraftDetailView.swift`
- **功能**: 草稿详情视图
- **主要功能**:
  - 显示笔记录入失败信息
  - 显示原视频链接
  - 重新记录按钮
  - 删除按钮
- **转换说明**: 从 `DraftDetailPage.tsx` 转换

#### 3. `QuotaDetailView.swift`
- **功能**: 用户额度详情视图
- **主要功能**:
  - 圆形进度条显示额度使用情况
  - 额度状态显示
  - 额度说明文字
- **转换说明**: 从 `AIConfigPage.tsx` 转换
- **特殊处理**: 使用自定义 `CircularProgressView` 替代 React 的 `recharts` 库

#### 4. `HelpView.swift`
- **功能**: 帮助与支持视图
- **主要功能**:
  - 应用 Logo 和版本信息
  - 指南与文档
  - 常见问题
  - 反馈与联系
  - 开发者信息
- **转换说明**: 从 `AboutPage.tsx` 转换

---

## 📂 Components 文件夹

### 功能说明
存放可复用的 UI 组件。

### 文件列表

#### 1. `GlassCard.swift`
- **功能**: 玻璃态卡片组件（通用容器）
- **特性**:
  - 半透明背景
  - 渐变叠加效果
  - 边框和阴影
  - 圆角设计
- **转换说明**: 
  - 从 React 的 `className` 样式转换为 SwiftUI 的修饰符
  - Tailwind 的 `backdrop-blur` 转换为 SwiftUI 的 `Material` 效果
  - 使用 `@ViewBuilder` 支持内容注入

#### 2. `ToastView.swift`
- **功能**: 提示消息组件
- **特性**:
  - 自动显示/隐藏
  - 2秒后自动消失
  - 淡入淡出动画
- **转换说明**: 从 `Toast.tsx` 转换
- **特殊处理**: 使用 SwiftUI 的 `transition` 和 `animation` 实现动画

#### 3. `NoteRow.swift`
- **功能**: 笔记行组件
- **特性**:
  - 显示笔记图标、标题
  - 收藏按钮
  - 更多操作按钮
- **转换说明**: 从 React 的组件转换为 SwiftUI 视图

#### 4. `FolderRow.swift`
- **功能**: 文件夹行组件
- **特性**:
  - 展开/折叠指示器
  - 文件夹图标和标题
  - 收藏按钮
  - 更多操作按钮
- **转换说明**: 从 React 的组件转换为 SwiftUI 视图

#### 5. `FavoriteGridItem.swift`
- **功能**: 收藏网格项组件
- **特性**:
  - 固定尺寸（160x160）
  - 图标和标题显示
  - 点击交互
- **转换说明**: 从 React 的网格项转换为 SwiftUI 视图

#### 6. `CircularProgressView.swift`
- **功能**: 圆形进度条组件
- **特性**:
  - 自定义圆形进度显示
  - 渐变颜色
  - 中心显示数值
- **转换说明**: 
  - 从 React 的 `recharts` PieChart 转换为 SwiftUI 自定义视图
  - 使用 `Circle` 和 `trim` 实现进度效果

#### 7. `TabBar.swift`
- **功能**: 底部标签栏组件
- **特性**:
  - 三个标签：最近内容、我的笔记、设置
  - 活动状态高亮
  - 玻璃态效果
- **转换说明**: 从 `TabBar.tsx` 转换
- **枚举**: `Tab` - 标签类型枚举

---

## 📂 Sheets 文件夹

### 功能说明
存放底部弹出的表单视图（iOS 风格的 Sheet）。

### 文件列表

#### 1. `ActionSheetView.swift`
- **功能**: 操作表单（收藏/删除）
- **特性**:
  - 收藏/取消收藏选项
  - 删除选项
  - 取消按钮
  - 半透明背景遮罩
- **转换说明**: 从 `ActionSheet.tsx` 转换
- **特殊处理**: 使用 SwiftUI 的 `sheet` 修饰符和 `@Environment(\.dismiss)`

#### 2. `CategorySheetView.swift`
- **功能**: 分类选择表单
- **特性**:
  - 显示所有分类列表
  - 选择分类后关闭
  - 可滚动列表
- **转换说明**: 从 `CategorySheet.tsx` 转换

#### 3. `AddFolderSheetView.swift`
- **功能**: 添加文件夹表单
- **特性**:
  - 文本输入框
  - 创建/取消按钮
  - 输入验证
- **转换说明**: 从 `AddFolderSheet.tsx` 转换

#### 4. `ShareSheetView.swift`
- **功能**: 分享表单
- **特性**:
  - 文件预览卡片
  - 分享选项（AirDrop、邮件、拷贝、存储到文件）
  - 取消按钮
- **转换说明**: 从 `DataManagementPage.tsx` 中的分享部分转换

---

## 📂 Extensions 文件夹

### 功能说明
存放 Swift 扩展，用于扩展系统类型。

### 文件列表

#### 1. `Color+Extensions.swift`
- **功能**: Color 扩展
- **内容**:
  - `noteyBackgroundStart` - 背景渐变色起始（#87CEEB）
  - `noteyBackgroundEnd` - 背景渐变色结束（黑色）
  - `noteyBlob1` - 装饰性元素颜色1（#5DADE2）
  - `noteyBlob2` - 装饰性元素颜色2（#3498DB）
  - `noteyBlob3` - 装饰性元素颜色3（#1C1C1C）
- **转换说明**: 从 CSS 颜色值转换为 SwiftUI Color

---

## 📂 Managers 文件夹

### 功能说明
存放应用的状态管理器。

### 文件列表

#### 1. `ToastManager.swift`
- **功能**: 提示消息管理器
- **特性**:
  - `@Published var message` - 消息内容
  - `@Published var isVisible` - 显示状态
  - `show(_:)` - 显示消息方法
- **转换说明**: 
  - 从 React 的 `useState` 转换为 SwiftUI 的 `ObservableObject`
  - 使用 `@Published` 实现响应式更新

---

## 📄 主文件

### 1. `ContentView.swift`
- **功能**: 主视图控制器
- **主要职责**:
  - 管理应用的主要状态
  - 协调各个视图之间的导航
  - 处理用户交互
- **状态管理**:
  - `@State private var activeTab` - 当前活动标签
  - `@State private var uncategorizedNotes` - 未分类笔记
  - `@State private var draftNotes` - 草稿笔记
  - `@State private var personalLibrary` - 个人笔记库
  - `@State private var selectedDraft` - 选中的草稿
  - `@State private var selectedNote` - 选中的笔记
  - `@StateObject private var toastManager` - 提示消息管理器
- **视图结构**:
  - 背景渐变和装饰性元素
  - 标题栏
  - 内容区域（根据标签切换）
  - 底部标签栏
- **转换说明**: 
  - 从 `App.tsx` 转换
  - React 的组件组合转换为 SwiftUI 的视图构建器
  - React 的条件渲染转换为 SwiftUI 的 `if-else` 视图

### 2. `NoteyApp.swift`
- **功能**: 应用入口
- **内容**: 
  - `@main` 标记的应用入口点
  - `WindowGroup` 场景
- **转换说明**: 标准的 SwiftUI 应用结构

---

## 🔄 主要转换对照表

### 样式转换

| React/Tailwind | SwiftUI |
|---------------|---------|
| `className="bg-white/15"` | `.fill(.white.opacity(0.15))` |
| `backdrop-blur-2xl` | `.background(.ultraThinMaterial)` |
| `rounded-[30px]` | `.cornerRadius(30)` |
| `shadow-2xl` | `.shadow(color:radius:x:y:)` |
| `border border-white/40` | `.overlay { RoundedRectangle(...).stroke(...) }` |
| `flex items-center` | `HStack { ... }` |
| `space-y-3` | `VStack(spacing: 12) { ... }` |

### 状态管理转换

| React | SwiftUI |
|------|---------|
| `useState` | `@State` |
| `useState` (共享) | `@Binding` |
| `useEffect` | `.onAppear` / `.onChange` |
| Context API | `@EnvironmentObject` / `@StateObject` |

### 组件转换

| React | SwiftUI |
|------|---------|
| `function Component()` | `struct Component: View` |
| `return <div>...</div>` | `var body: some View { ... }` |
| `onClick={handler}` | `.onTapGesture { handler() }` |
| `className={...}` | `.modifier(...)` |
| `{condition && <View />}` | `if condition { View() }` |

### 导航转换

| React | SwiftUI |
|------|---------|
| 条件渲染全屏覆盖 | `.fullScreenCover(isPresented:)` |
| 底部表单 | `.sheet(isPresented:)` |
| 路由导航 | `NavigationLink` / `NavigationStack` |

---

## 🎨 设计系统转换

### 颜色系统
- **背景渐变**: 从天蓝色 (#87CEEB) 到黑色
- **玻璃态效果**: 半透明白色背景 + 模糊效果
- **装饰性元素**: 三个模糊的圆形（blob）动画

### 字体系统
- **标题字体**: Aclonica（自定义字体）
- **正文字体**: 系统默认字体
- **字体大小**: 从 px 转换为 SwiftUI 的 point 系统

### 间距系统
- **基础间距**: 4pt 的倍数（对应 Tailwind 的 spacing 系统）
- **圆角**: 15px, 20px, 25px, 30px 等

---

## 📝 注意事项

1. **数据持久化**: 当前实现使用 `@State`，实际应用中应使用 `@AppStorage` 或 Core Data
2. **网络请求**: 草稿中的视频链接处理需要实际的网络请求实现
3. **字体**: Aclonica 字体需要在项目中添加字体文件
4. **动画**: 装饰性 blob 动画可以使用 SwiftUI 的 `Animation` 实现
5. **性能优化**: 大量列表项应考虑使用 `LazyVStack` 和 `LazyHStack`

---

## 🚀 后续优化建议

1. **数据持久化**: 集成 SwiftData 或 Core Data
2. **网络层**: 添加 API 请求层
3. **错误处理**: 添加完善的错误处理机制
4. **单元测试**: 为关键组件添加单元测试
5. **可访问性**: 添加 VoiceOver 支持
6. **国际化**: 支持多语言
7. **深色模式**: 适配 iOS 深色模式

---

## 📅 转换完成日期

2026年1月12日

---

## 👤 转换说明

本转换文档详细记录了从 React/TypeScript Web 应用转换为 SwiftUI iOS 应用的完整过程，包括：
- 文件夹结构说明
- 每个文件的功能和转换说明
- 样式和组件的转换对照
- 设计系统的转换
- 注意事项和优化建议

所有代码已按照 iOS 开发最佳实践进行组织，便于后续维护和扩展。
